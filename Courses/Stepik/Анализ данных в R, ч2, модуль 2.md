## Анализ данных в R. Часть 2
###  Подробнее о визуализации
#### Грамматика ggplot2, функция qplot
**Задачи:**  
**1:** Используя функцию qplot, постройте гистограмму переменной depth из данных diamonds. Сохраните график в переменную depth_hist.
```{r}
depth_hist <- qplot(diamonds$depth)
```
**2:** Теперь давайте отобразим сразу три переменные на одном графике!
Постройте диаграмму рассеивания (scatter plot) как в указанном ниже примере, результат сохраните в переменную price_carat_clarity_points.
данные - diamonds
ось x - carat
ось y - price
цвет точек - clarity
```{r}
price_carat_clarity_points <- qplot(x=carat,y=price,color=clarity,data=diamonds)
```
**3:** Используя функцию qplot, постройте график плотности переменной x из данных diamonds. Сохраните график в переменную x_density.
```{r}
x_density <- qplot(x = x, data = diamonds, geom = "density")
```
**4:** Усложним задачу, постройте график плотности переменной x для каждой группы наблюдений по переменной cut из данных diamonds. Таким образом за цвет графика теперь отвечает переменная cut. Сохраните результат в переменную x_cut_density.
```{r}
x_cut_density <-qplot(x=x, geom='density',color=cut, data=diamonds)
```
**5:** Давайте знакомиться с различными geoms. Документация пакета и весь список с примерами использования доступен здесь. Вообще обратите внимание на документацию ggplot2, очень подробное описание основных возможностей пакета!
Давайте построим график violin plot для переменной price в каждой группе наблюдений по переменной color. Сохраните результа в переменную price_violin.
```{r}
price_violin <- qplot(x = color,
      y = price,
      data = diamonds,
      geom = "violin")
```
#### Функция ggplot и различные geoms
**Задачи:**  
**1:** Давайте потренируемся комбинировать различные geoms на одном графике. Используя данные mtcars скомбинируем два варианта отображения количественных данных boxplot и violin plot.
ось x - am (нужен фактор)
ось y - mpg
Сохраните график в переменную my_plot.
```{r}
my_plot <- ggplot(mtcars,aes(factor(am),mpg))+geom_violin()+geom_boxplot(width = 0.2)
```
**2:** Отобразите взаимосвязь между доходом (income) и числом продаж (sale), цветом точек указав номер магазина (shop):
Сохраните график в переменную my_plot. Обратите внимание, что линия тренда одна для всех наблюдений. Данные хранятся в переменной sales.
```{r}
my_plot <- ggplot(mtcars,aes(factor(am),mpg))+geom_violin()+geom_boxplot(width = 0.2)
```
**3:** При помощи функции stat_summary постройте график с доверительными интервалами для демонстрации различий в доходах двух магазинов с учетом времени года:
переменная shop - ось x;
переменная income - ось y;
переменная season - цвет;
geom pointrange.
Сохраните график в переменную my_plot, дополнив предложенный код. Обратите внимание, что доверительные интервалы не накладываются друг на друга! 
```{r}
my_plot <- ggplot(sales, aes(shop, income, col = season)) +
  stat_summary(fun.data = mean_cl_boot,
               position = position_dodge(0.2),
               size = 1)
```
**4:** Теперь давайте отобразим на графике различия в продажах (переменная sale), в зависимости от:
года (date) - ось x;
и номера магазина (shop) - цвет.
Используйте функцию mean_cl_boot для построения доверительных интервалов.Вам также понадобится использовать три geoms: errorbar, point, line. Используйте их прямо внутри функции stat_summary().
```{r}
my_plot <- ggplot(sales, aes(date,sale,col=shop))+
  stat_summary(fun.data = mean_cl_boot,geom='errorbar', position = position_dodge(0.2)) + # добавим стандартную ошибку
  stat_summary(fun.data = mean_cl_boot,geom='point',position = position_dodge(0.2)) + # добавим точки
  stat_summary(fun.data = mean_cl_boot,geom='line',position = position_dodge(0.2))
```
####Facet - способы группировки данных на графике
**Задачи:**  
**1:** Потренируемся с разбиением графика на подгруппы! Используя facet_grid постройте следующий график и сохраните его в переменную mpg_facet.
ось x - переменная mpg
facet - переменная am по строчкам и vs по столбцам
```{r}
mpg_facet <- ggplot(mtcars,aes(mpg))+geom_dotplot()+facet_grid(am~vs)
```
**2:** Используя данные iris, постройте график плотности для переменной Sepal.Length. Разбейте график на части по переменной Species при помощи facet_wrap. Результат сохраните в переменную sl_wrap.
```{r}
sl_wrap <- ggplot(iris,aes(Sepal.Length))+geom_density()+facet_wrap(~Species)
```
**3:** Используя данные Iris, постройте график, иллюстрирующий взаимосвязь переменных Sepal.Length и Sepal.Width внутри каждого вида (переменной Species), при помощи facet_wrap().
В этом задании вам потребуется использовать два geom:
geom_point - для отображения отдельных наблюдений,
geom_smooth - для добавления сглаживания.
Сохраните график в переменную my_plot.
```{r}
my_plot <- ggplot(iris,aes(Sepal.Length, Sepal.Width))+geom_point()+
  facet_wrap(~Species)+geom_smooth()
```
**4:** Давайте построим следующий график, чтобы выяснить есть ли различия в бюджетах фильмов разного жанра из года в год. Cохраните результат в переменную my_plot.
ось x - переменная Type
ocь y - переменная Budget
facet - переменная Year (используйте facet_grid)
```{r}
my_plot <- ggplot(myMovieData, aes(Type, Budget)) + 
  geom_boxplot() + 
  facet_grid(. ~ Year) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```










